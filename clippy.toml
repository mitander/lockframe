msrv = "1.93"

cognitive-complexity-threshold = 30
too-many-lines-threshold = 100
too-many-arguments-threshold = 9
type-complexity-threshold = 250
single-char-binding-names-threshold = 4
enum-variant-size-threshold = 200
array-size-threshold = 512000

# Allow expect/unwrap in test code (#[cfg(test)] modules and #[test] functions)
allow-expect-in-tests = true
allow-unwrap-in-tests = true
allow-panic-in-tests = true

disallowed-methods = [
    { path = "std::time::Instant::now", reason = "Determinism violation: Use Environment::now()" },
    { path = "std::time::SystemTime::now", reason = "Determinism violation: Use Environment::wall_clock_secs()" },
    { path = "std::thread::sleep", reason = "Determinism violation: Use Environment::sleep()" },
    { path = "rand::thread_rng", reason = "Determinism violation: Use Environment::random_bytes()" },
    { path = "std::mem::forget", reason = "Use ManuallyDrop or proper ownership instead" },
    { path = "std::vec::Vec::leak", reason = "Leaking memory is incorrect in long-running servers" },
    { path = "std::boxed::Box::leak", reason = "Leaking memory is incorrect in long-running servers" },
    { path = "std::env::set_var", reason = "Not thread safe; use a config struct" },
    { path = "std::env::remove_var", reason = "Not thread safe; use a config struct" },
]

disallowed-macros = [
    { path = "std::print", reason = "Use tracing::info! or tracing::debug! instead" },
    { path = "std::println", reason = "Use tracing::info! or tracing::debug! instead" },
    { path = "std::eprint", reason = "Use tracing::error! instead" },
    { path = "std::eprintln", reason = "Use tracing::error! instead" },
    { path = "std::dbg", reason = "Use tracing::debug! instead" },
]
